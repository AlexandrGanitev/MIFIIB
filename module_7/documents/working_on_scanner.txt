Доброе утро! Посмотрел код, давайте по пунктам:
Ошибка
TypeError: int() argument must be a string, a bytes-like object or a real number, not ‘NoneType’
Вылезает, потому что нужно привести строку, которую Вы отправляете на сокет, в необходимый вид. Либо в байты перевести, либо предоставить это питону, закодировав строку в utf-8:
self.wfile.write(f"The list of successfully pinged IP addresses: {ping_list}".encode())
2. Сканируется только один ip адрес, потому что отсутствует цикл, в котором будут перебираться ip адреса. Если я правильно помню, у Вас раньше функция сканирования вызывалась внутри цикла for, который перебирал последние октеты начиная с res[3] до res[3]+num_of_hosts.
А сейчас судя по выводу - функция запускается один раз, берет начальный ip, прибавляет к нему num_of_hosts, получает 120 в последнем октете (115+5) и выводит результат для одного ip адреса. В общем, нужно в функции сделать цикл for для перебора последних октетов. Что-то вроде
for last_octet in num_of_hosts:
   res[3] + last_octet
   response = os.popen(f'ping -c 1 {scanned_ip}')
res = response.readlines()
(Код примерный, работоспособность не проверял: нужно проверить чтобы переменные не перезаписывались)
Думаю, если добавите encode() в возвращение ответа и добавите перебор последних октетов, должно заработать


Константин З.
  17 hours ago
По поводу 3 функций: ping sweep и GET\POST
Как вариант - использовать do_GET для обработки ping sweep, а в do_POST просто парсить приходящее значение метода.
Т.е. важно разделять: то что Вы на API отправляете GET или POST - это просто Ваша реализация API. Вы сами задаете правила как и что отправлять. А вот куда и в каком виде оно потом дальше отправит http request - это можно задавать параметрами. Например, я хочу отправить GET запрос на ya.ru. Тогда:
Отправляю POST запрос на API, а в теле запроса указываю:
{"method": "GET", "url":"https://ya.ru"}
Нужно только реализовать обработчик, чтобы он тело запроса парсил правильно. Здесь может пригодиться библиотека json.
У нее есть метод json.loads(), который выгрузит формат json и сразу его распарсит.
И если я захочу получить значения method (из примера выше):
payload = json.loads(temp)
if method in payload == "GET":
   <отправляем GET запрос>
elif method in payload == "POST":
   <отправляем POST запрос>
Опять же, пишу из головы, так что нужно смотреть детально. Но концепция такая
Если не получится - пишите, будем еще разбираться. И извиняюсь за долгий ответ


Ганицев Александр Сергеевич
  13 hours ago
@Константин З.
Благодарю Константин, что-то понимаю, что-то нет. Самая большая проблема для меня - это когда программа была standalone, я наконец разобрался, как идёт поток выполнения. Теперь, с запуском http server-a я не вижу вывод(!), и мне вообще не понятны изменения, которые я делаю, т.е. как говорил Конфуций: «нельзя искать чёрную кошку в тёмной комнате, особенно если там её нет»… Программа не простейшая, много увязано, и некоторые изменения и то, что они поломали, не видны такому неспециалисту как я.
Принцип реализации цикла - буду ломать голову, я тоже вчера понял про 115+5=120, что нужно добавлять цикл, что я вырезал с argparse, думаю, куда именно его вставить. Надеюсь, с вашими советами и помощью разберусь. За encode() спасибо, сам бы я и не понял!
Потом займусь POST. Потом Докер. Не знаю, если смогу понять и сдать работу, не серчайте.
@Юлия Черкас
 Юлия, я посмотрел форму продления сдачи и … ничего не понял, сдам эту работу, как только разберусь, я вам отдельно вчера написал. Сейчас, с помощью Константина разбираюсь, понимание приходит очень медленно, и даже пройденный курс «Основы Питона» не помогает.
 (edited)


Константин З.
  6 hours ago
@Александр
 Сейчас заметил одну деталь. Позвольте узнать, Вы используете Postman в браузере? Веб-версию?


Константин З.
  6 hours ago
Из скриншотов вижу, что ошибка вылезла, как в веб-версии, но дальнейшие сообщения показали, что Ping sweep у Вас запустился, а это могло произойти только в десктопной версии. Т.к. веб-версия не достанет до Вашего localhost:3009, поэтому возник диссонанс :)
Если сначала пробовали на веб-версии, а потом перешли на десктопную - отлично, так и нужно. С веб-версии Вы не сможете отправлять запросы на свою API


Ганицев Александр Сергеевич
  6 hours ago
@Константин З.
 Я не устанавливал десктопной версии Postman ещё, для запуска сканера лучше установить десктопную?
Я наверное не до конца понял, что такое API.
То есть в моём примере (main.py, содержащая ping sweep и sendhttp функции) это будут те две функции do_GET и do_POST принадлежащие объекту http.server?
Я всё думаю, куда воткнуть цикл из вырезанного аргпарса.
Самое важное для меня это понять, как элементы работают:
Запускаем main.py, стартует http.server
В Postman отправляю request GET, стучусь по localhost:3009(мой порт) в браузере
В поле body указываю IP и номер количества хостов и в нижнем поле вижу результат?
В оригинальном сканере я передавал аргументы через аргпарс: python3 scanner.py scan -i 192.168.1.1 -n 5, здесь не вникну никак, куда их передавать. Мне бы пример кода сканера с API увидеть… В непонимании кода и вся загвоздка, увижу пример, по образу и подобию соберу мою программу, и оформлю в Докере.
Вы уж извините меня Константин, что беспокою своими вопросами, да ещё на выходных. (edited)


Константин З.
  5 hours ago
@Александр

"То есть в моём примере (main.py, содержащая ping sweep и sendhttp функции) это будут те две функции do_GET и do_POST принадлежащие объекту http.server?"
Да, это обработчики, которые будут вызывать Ваши функции ping sweep и sendhttp.
Цикл для перебора можете использовать прямо внутри обработчика do_GET
"Самое важное для меня это понять, как элементы работают:
Запускаем main.py, стартует http.server
В Postman отправляю request GET, стучусь по localhost:3009(мой порт) в браузере
В поле body указываю IP и номер количества хостов и в нижнем поле вижу результат?"
Да, все верно, только без браузера. Суть API как раз в том, чтобы не использовать браузер - Вы посылаете запрос с параметрами, Ваш скрипт выполняет необходимые действия и возвращает Вам ответ (Postman в своём окошке выведет результаты).
Лучше воспользуйтесь десктопной версией Postman, с нее Вы сможете отправлять запрос и видеть ответ сразу. Веб-версия не может отправлять запросы на localhost.
"В оригинальном сканере я передавал аргументы через аргпарс: python3 scanner.py scan -i 192.168.1.1 -n 5, здесь не вникну никак, куда их передавать."
Их передавать нужно в body. Только Вы не просто передаете IP и количество хостов, а нужно еще в самом API еще обрабатывать то, что приходит в body
Набросал пример обработчика do_GET, который выполняет сканирование строго 2-ух хостов, начиная с IP адреса, который я отправил в body. Надеюсь поможет:
def do_GET(self):
    temp = self._set_headers()
    self.send_response(200)
    self.send_header("Content-type", "text/json")
    self.end_headers()
    ip_parts = temp.split('.')
    network_ip = ip_parts[0] + '.' + ip_parts[1] + '.' + ip_parts[2] + '.'
    ping = "ping -c 1 "
    time1 = datetime.datetime.now()
    for ip in range(0, 2):
        addr = network_ip + str(ip)
        print(addr)
        command = ping + addr
        response = os.popen(command)
        res = response.readlines()

        for line in res:
            if (line.count("ttl")):
                self.wfile.write(("\n" + addr + "----- LIVE\n").encode())

    time2 = datetime.datetime.now()
    total_time = time2 - time1
    self.wfile.write((f"Complete! in {total_time}").encode())
Извиняюсь за отсутствие комментариев и неаккуратность, времени было немного)


Константин З.
  5 hours ago
Пример запроса и ответа из Postman:
image.png

image.png


Константин З.
  5 hours ago
Даже немного накосячил в цикле - цикл должен быть такой:
for ip in range(int(ip_parts[3]), int(ip_parts[3])+2)
(Начальная точка - переданный последний октет, последняя точка - переданный последний октет + 2. В Вашем случае вместо 2 должен быть параметр number_of_hosts)


Ганицев Александр Сергеевич
  4 hours ago
Надеюсь понял Константин, сейчас свет дадут, буду набивать и тестировать. Сложиться сканер, загоню в Докер.


Ганицев Александр Сергеевич
  4 hours ago
Дали свет! Извините ещё раз за то, что задёргал со своими вопросами. Буду ваш пример разбирать и пробовать.